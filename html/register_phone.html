<!doctype html>
<html>

<head>
	<meta charset="UTF-8">
	<title>注册-手机验证-店员版</title>
	<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
	<link href="../css/mui.min.css" rel="stylesheet" />
	<link rel="stylesheet" type="text/css" href="../css/register_phone.css" />
</head>

<body style="background-color: white;">
	<header class="mui-bar mui-bar-nav mui-bar-nav-bg" style="background-color: white; box-shadow: none; border-bottom: 1px solid #CCCCCC;">
		<span class="mui-icon mui-icon-back"></span>
		<span class="mui-title" style="font-size: 18px; color: #333333;">用户注册</span>
	</header>
	<div class="mui-content" style="background-color: white;">
		<div id="time-line-content">
			<div id="line">
				<div id="line-front"></div>
				<div id="line-back"></div>
			</div>
			<div id="round-front"></div>
			<div id="round-middle"></div>
			<div id="round-back"></div>
			<div id="font-front">选择身份</div>
			<div id="font-middle">手机验证</div>
			<div id="font-back">设置密码</div>
		</div>
		<div class="phonetest-content">
			<div class="phone-content">
				<div class="phone-info">手机号</div>
				<div class="phone-number-input">
					<input type="number" id="phone_number" placeholder="请输入手机号" />
				</div>
			</div>
			<div class="test-content">
				<div class="test-info">验证码</div>
				<div class="test-code-input">
					<input type="text" id="yanzheng_number" placeholder="请输入验证码" />
				</div>
				<input type="button" class="test-code-btn" value="获取验证码"></input>
			</div>
			<div class="next-content">
				<!-- <a href="register_password.html"> -->
				<!-- <button class="next-btn">下一步</button> -->
				<!-- </a> -->
				<button class="next-btn">注册</button>
				<a href="login.html">
					<span class="had">已有账号立即登录</span>
				</a>
			</div>
		</div>
		<div class="bottom-font">
			GO佳居网
		</div>
	</div>
</body>
<script src="../js/mui.min.js"></script>
<script type="text/javascript" src="../js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="../js/icon-back.js"></script>
<script src="../js/util.js"></script>
<script type="text/javascript">

	mui.init(
		nextBtn()
	)
	function nextBtn() {
		$('.next-btn').on('tap', function () {
			register()
		})
	}

	// 手机号格式
	function phoneNum(obj){
		var p = /^[1][3,4,5,7,8][0-9]{9}$/;
		if(obj == ''){
			mui.toast('手机号为空')
		}else if(p.test(obj) == false){
			mui.toast('请输入正确手机号')
		}
	}
	function istestCode(str){
		var d = /^[\x01-\xfe]{8,20}$/
		if(str == ''){
			mui.toast('请输入密码')
		}else if(d.test(str) == false){
			mui.toast('密码为8-20位')
		}
	}
	// 获取注册接口
	function register() {
		var testCode = $('#yanzheng_number').val()
		var phoneNumber = $('#phone_number').val()
		var OperatorType = localStorage.getItem('OperatorType')	
		phoneNum(phoneNumber)
		istestCode(testCode)
		console.log(testCode)
		console.log(phoneNumber)
		console.log(OperatorType)		
		mui.ajax('http://39.98.77.177:8080/api/registerOperator', {
			data: {
				"operatorMobile": phoneNumber,
				"operatorType": OperatorType,
				"password": testCode,
				"status": true
			},
			dataType: 'json', //服务器返回json格式数据
			type: 'post', //HTTP请求类型
			timeout: 10000, //超时时间设置为10秒
			headers: {
				'Content-Type': 'application/json',
			},
			success: function (data) {
				console.log(data)
				mui.openWindow(
					'login.html',
					'login',
					{}
				)
			},
			error: function (xhr, type, errorThrown) {
				//异常处理；
				
				
			}
		});
	}
</script>

</html>