<!doctype html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>客户案例-案例描述</title>
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />

		<link href="../css/mui.min.css" rel="stylesheet" />
		<link rel="stylesheet" type="text/css" href="../css/customer_case_description.css" />
	</head>
	<body style="background-color: white;">
		<header class="mui-bar mui-bar-nav mui-bar-nav-bg" style="background-color: white; box-shadow: none; border-bottom: 1px solid #EEEEEE;">
			<span class="mui-icon mui-icon-back"></span>
			<span class="mui-title" style="font-size: 18px; color: #333333;">发布案例</span>
		</header>
		<div class="mui-content" style="background-color: white;">
			<div id="time-line-content">
				<div id="line">
					<div id="line-front"></div>
					<div id="line-middle"></div>
					<div id="line-back"></div>
				</div>
				<div id="round-attribute">
					<img src="../img/attribute.png" style="width: 100%; height: 100%;" />
				</div>
				<div id="round-description">
					<img src="../img/description.png" style="width: 100%; height: 100%;" />
				</div>
				<div id="round-relate-products">
					<img src="../img/relate-products1.png" style="width: 100%; height: 100%;" />
				</div>
				<div id="round-customer-information">
					<img src="../img/customer-information1.png" style="width: 100%; height: 100%;" />
				</div>
				<div id="font-attribute">案例属性</div>
				<div id="font-description">案例描述</div>
				<div id="font-relate-products">关联产品</div>
				<div id="font-customer-information">客户信息</div>
			</div>
			<div id="test">
				asas
			</div>
			<img id="img">
			<div class="case-name">
				<div class="case-name-caption">
					案例名称
				</div>
				<div class="case-name-input-content">
					<input class="case-name-input" placeholder="请填写案例名称" />
					<img src="../img/pen.png" class="case-name-icon" />
				</div>
			</div>
			<div class="case-image">
				<div class="case-image-caption">
					案例形象图
				</div>
				<div class="case-image-content">
					<div class="case-image-album-container">
						<div class="case-image-album" onclick="showPop();">
							<img src="../img/album.png" class="case-image-icon" />
						</div>
						<div class="case-image-album-caption">
							点击上传案例形象图
						</div>
					</div>
					<button class="case-image-modify-btn">修改</button>
				</div>
			</div>

			<div class="case-description">
				<div class="case-description-caption">
					案例描述
				</div>
				<div class="case-description-input-content">
					<textarea class="case-description-input" id="case-description" placeholder="请填写对该案例的描述（不超过200个字）"></textarea>
					<img src="../img/pen.png" class="case-description-icon" />
				</div>
			</div>
			<div class="batch-case-image">
				<div class="batch-case-image-caption">
					上传案例图片
				</div>
			</div>
			<div class="edit-case">
				<div id="case-pic">
					<img src="../img/dgybanner.png" style="width: 100%; height: 100%;" />
					<a href="#"><button id="edit-function-change">修改</button> </a>
					<a href="#"><button id="edit-function-delete"><span class="mui-icon mui-icon-trash"></span></button> </a>
				</div>
				<div class="edit-content">
					<input class="prompt-input" placeholder="添加图片名称" />
					<a href="customer_case_description_imageName.html">
						<div class="edit-icon-content">
							<div class="edit-icon-icon">
								<span class="mui-icon mui-icon-arrowright"></span>
							</div>
							<div class="edit-icon-font">编辑</div>
						</div>
					</a>
				</div>
				<div class="edit-content">
					<input class="prompt-input" placeholder="添加图片描述（不超过200个字）" />
					<div class="edit-icon-content">
						<div class="edit-icon-icon">
							<span class="mui-icon mui-icon-arrowright"></span>
						</div>
						<div class="edit-icon-font">编辑</div>
					</div>
				</div>
			</div>
			<div class="edit-case">
				<div id="case-pic">
					<img src="../img/dgybanner.png" style="width: 100%; height: 100%;" />
					<a href="#"><button id="edit-function-change">修改</button> </a>
					<a href="#"><button id="edit-function-delete"><span class="mui-icon mui-icon-trash"></span></button> </a>
				</div>
				<div class="edit-content">
					<input class="prompt-input" placeholder="添加图片名称" />
					<a href="customer_case_description_imageName.html">
						<div class="edit-icon-content">
							<div class="edit-icon-icon">
								<span class="mui-icon mui-icon-arrowright"></span>
							</div>
							<div class="edit-icon-font">编辑</div>
						</div>
					</a>
				</div>
				<div class="edit-content">
					<input class="prompt-input" placeholder="添加图片描述（不超过200个字）" />
					<div class="edit-icon-content">
						<div class="edit-icon-icon">
							<span class="mui-icon mui-icon-arrowright"></span>
						</div>
						<div class="edit-icon-font">编辑</div>
					</div>
				</div>
			</div>
			<div class="batch-case-image-content">
				<div class="batch-case-image-album">
					<img src="../img/anli.png" class="batch-case-image-icon" />
				</div>
				<div class="batch-case-image-album-caption">
					点击批量上传案例图
				</div>
			</div>
			<a href="customer_case_related_products_none.html"><button class="next-btn">下一步</button></a>
			<div id="sheet1" class="mui-popover mui-popover-bottom mui-popover-action ">
				<!-- 可选择菜单 -->
				<ul class="mui-table-view">
					<li class="mui-table-view-cell">
						<a href="#">拍照</a>
					</li>
					<li class="mui-table-view-cell">
						<a href="#">从相册选取</a>
					</li>
				</ul>
				<!-- 取消菜单 -->
				<ul class="mui-table-view">
					<li class="mui-table-view-cell">
						<a href="#sheet1">取消</a>
					</li>
				</ul>
			</div>
		</div>
	</body>
	<script src="../js/mui.min.js"></script>
	<script type="text/javascript" src="../js/jquery-1.11.0.min.js"></script>
	
	<!-- <script src="../js/qiniuUploader.js"></script> -->
	<script type="text/javascript" src="../js/icon-back.js"></script>
	<script src="../js/util.js"></script>
	<script type="text/javascript">
		mui.init()
		function showPop() {
			if (mui.os.plus) {
				var buttonTit = [{
					title: "拍照"
				}, {
					title: "从手机相册选择"
				}];

				plus.nativeUI.actionSheet({
					title: "上传案例形象图",
					cancel: "取消 ",
					buttons: buttonTit
				}, function(b) { /*actionSheet 按钮点击事件*/
					switch (b.index) {
						case 0:
							break;
						case 1:
							getCamera(); /*拍照*/
							break;
						case 2:
							getgallery(); /*打开相册*/
							break;
						default:
							break;
					}
				})
			}
		}

		function getCamera() {
			var c = plus.camera.getCamera();
			c.captureImage(function(e) {
				plus.io.resolveLocalFileSystemURL(e, function(entry) {
					var imgSrc = entry.toLocalURL() + "?version=" + new Date().getTime(); //拿到图片路径
					console.log(entry)
					// 上传到七牛
					getQiniuToken(entry);
				}, function(e) {
					console.log("读取拍照文件错误：" + e.message);
				});
			}, function(s) {
				console.log("error" + s);
			}, {
				filename: "_doc/camera/"
			});
		}

		function getgallery() {
			// 从相册中选择图片
			plus.gallery.pick(function(e) {
				var fileSrc = e.files[0];
				console.log(fileSrc)
				// 上传到七牛
				getQiniuToken(fileSrc);
			}, function(e) {
				console.log("取消选择图片");
			}, {
				filter: "image",
				multiple: true,
				maximum: 1,
				system: false,
				onmaxed: function() {
					plus.nativeUI.alert('最多只能选择1张图片');
				},
			})
		}
		
		function getQiniuToken(src){
			$util.uploadToQiniu(src,function(imgPath){
				//imgPath--完整的url
			});
		}
		
		
		$("#case-description").on("input propertychange", function() {
			var $this = $(this),
				_val = $this.val(),
				count = "";
			if (_val.length > 200) {
				$this.val(_val.substring(0, 200));
				alert("案例描述不得超过200个字！");
			}
			count = 200 - $this.val().length;
			$("#text-count").text(count);
		});
	</script>
</html>
